note this is all in power shell but oh well
note we will need to add a file to the users program files and then move all of our stuff into it -- this will involve doing nice internal file manage 


Invoke-WebRequest https://downloads.arduino.cc/arduino-cli/nightly/arduino-cli_nightly-latest_Windows_64bit.zip -O arduino-cli.zip
Expand-Archive -LiteralPath arduino-cli.zip -DestinationPath arduino-cli
$PATH = [Environment]::GetEnvironmentVariable("PATH", "Machine")
$arduino_cli = ""
if( $PATH -notlike "*"+$arduino_cli+"*" ){
    [Environment]::SetEnvironmentVariable("PATH", "$PATH;$arduino_cli", "Machine")
}
arduino-cli core update-index
arduino-cli core install arduino:avr


#note for this guy im risking it to see if skipping the yaml is doable
Invoke-WebRequest https://www.pjrc.com/teensy/td_156/package_teensy_index.json -O package_teensy_index.json

$cwd = (Get-Item .).FullName
$append = \AppData\Local\Arduino15
$target = Join-Path $cwd $append
Move-Item -LiteralPath package_teensy_index.json -DestinationPath $target

arduino-cli core install teensy:avr